# プロジェクトタスクリスト

## ✅ 完了済みタスク

### フェーズ1: 基盤実装
- [x] プロジェクト構造の初期化
- [x] D1データベース作成とマイグレーション
- [x] Weather Collector実装（OpenWeatherMap統合）
- [x] Metrics Exporter実装（Grafana用API）
- [x] Cloudflare Workersデプロイ
- [x] Cron設定（毎時0分実行）

### フェーズ2: Grafana統合
- [x] Infinity Datasource設定
- [x] ダッシュボード作成（温度、湿度、気圧、風速）
- [x] 時系列グラフ実装
- [x] 閾値設定（保育施設環境基準）

### フェーズ3: URL統一化
- [x] `childcare-`プレフィックス追加
- [x] 旧Workerの削除
- [x] ドキュメント更新

### フェーズ4: SwitchBot室内センサー連携
- [x] SwitchBot API v1.1クライアント実装
- [x] 室内センサーデータ用D1テーブル作成
- [x] Weather Collectorに室内データ収集機能追加
- [x] Metrics Exporterに室内データAPI追加
- [x] Grafanaダッシュボードに室内データパネル追加

## 📝 進行中のタスク

なし

## 📋 今後のタスク

### 高優先度 🔴

#### 1. OpenWeatherMap APIキー自動設定
- [x] APIキーの設定方法確認（`wrangler secret put OPENWEATHER_API_KEY`）
- [x] 本番環境へのSecret設定完了
- **完了**: 2025-09-03

#### 2. Grafanaアラート設定
- [ ] 温度アラート（18℃未満、30℃超過）
- [ ] 湿度アラート（40％未満、65％超過）
- [ ] 通知チャネル設定（Email/Slack）
- [ ] アラートルールのドキュメント作成
- **見積時間**: 3時間

### 中優先度 🟡

#### 3. API認証実装
- [ ] Bearer Token認証の実装
- [ ] API_KEY環境変数設定
- [ ] 認証ミドルウェア作成
- [ ] 認証設定ドキュメント
- **見積時間**: 3時間

#### 4. データベースクエリ最適化
- [ ] インデックス追加（timestamp）
- [ ] 集約クエリの最適化
- [ ] データ保持期間の設定（30日）
- [ ] パフォーマンステスト
- **見積時間**: 2時間

#### 5. README作成
- [ ] プロジェクト概要
- [ ] アーキテクチャ図
- [ ] セットアップガイド
- [ ] API仕様
- [ ] トラブルシューティング
- **見積時間**: 2時間

### 低優先度 🟢

#### 6. テスト追加
- [ ] Weather Collectorユニットテスト
- [ ] Metrics Exporterユニットテスト
- [ ] E2Eテスト
- [ ] テストカバレッジ80%以上
- **見積時間**: 4時間

#### 7. CI/CDパイプライン強化
- [ ] テスト自動実行
- [ ] リリースタグ自動作成
- [ ] Changelogの自動生成
- [ ] 環境別デプロイ（dev/staging/prod）
- **見積時間**: 3時間

#### 8. 機能拡張
- [ ] 複数地点対応
- [x] 室内センサー連携準備
- [ ] データエクスポート機能
- [ ] 月次レポート生成
- **見積時間**: 8時間

## 🎯 マイルストーン

### v1.0.0 - MVP（完了済み）
- ✅ 基本的な気象データ収集
- ✅ Grafanaダッシュボード
- ✅ 自動デプロイ

### v1.0.1 - 室内センサー連携（完了済み）
- ✅ SwitchBot API統合
- ✅ 室内温湿度データ収集
- ✅ 統合ダッシュボード（屋内・屋外）

### v1.1.0 - セキュリティ強化（目標: 2025年9月）
- [ ] API認証
- [ ] HTTPSのみ対応
- [ ] Rate Limiting

### v1.2.0 - 運用改善（目標: 2025年10月）
- [ ] アラート機能
- [ ] パフォーマンス最適化
- [ ] 包括的なドキュメント

### v2.0.0 - 機能拡張（目標: 2025年12月）
- [ ] 複数地点対応
- [x] 室内センサー連携
- [ ] レポート機能

## 📊 進捗サマリー

- **完了タスク**: 22個
- **残タスク**: 18個
- **進捗率**: 55%
- **次の優先タスク**: Grafanaアラート設定

## 🔄 更新履歴

- 2025-09-03: 初版作成、MVP完了
- 2025-09-03: URL統一化完了、今後のタスク整理
- 2025-09-03: SwitchBot室内センサー連携完了